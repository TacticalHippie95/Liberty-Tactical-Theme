<article
    class="card
    {{#if alternate}} card--alternate{{/if}}"
    data-test="card-{{id}}"
    data-gbproduct-id="{{id}}"
    {{#if settings.data_tag_enabled}}
        data-event-type="{{event}}"
        data-entity-id="{{id}}"
        data-position="{{position}}"
        data-name="{{name}}"
        data-product-category="
        {{#each category}}
            {{#if @last}}
                {{this}}
            {{else}}
                {{this}},
            {{/if}}
        {{/each}}"
        data-product-brand="{{brand.name}}"
        data-product-price="
        {{#if price.with_tax}}
            {{price.with_tax.value}}
        {{else}}
            {{price.without_tax.value}}
        {{/if}}"
    {{/if}}>
    <figure class="card-figure">
      {{#if out_of_stock_message }}
        {{> components/products/product-badge
            badge-type='sold-out'
            badge_view=theme_settings.product_sold_out_badges
            badge_label=theme_settings.pdp_sold_out_label
        }}
    {{/if}}

    {{#or price.sale_price_with_tax.value price.sale_price_without_tax.value}}
        {{> components/products/product-badge
            badge-type='sale'
            badge_view=theme_settings.product_sale_badges
            badge_label=theme_settings.pdp_sale_badge_label
        }}
    {{/or}}

        <a href="{{url}}"
           class="card-figure__link"
           aria-label="{{name}},{{> components/products/product-aria-label}}"
           {{#if settings.data_tag_enabled}} data-event-type="product-click" {{/if}}
        >
            <div class="card-img-container">
                {{> components/common/responsive-img
                    image=image
                    class="card-image"
                    fallback_size=theme_settings.productgallery_size
                    lazyload=theme_settings.lazyload_mode
                    default_image=theme_settings.default_image_product
                }}
            </div>
        </a>

        <figcaption class="card-figcaption">
            <div class="card-figcaption-body flex-align">

                {{#unless hide_product_quick_view}}
                    {{#if theme_settings.show_product_quick_view}}
                        {{#if settings.data_tag_enabled}}
                            <button type="button" class="button button--small card-figcaption-button quickview" data-event-type="product-click" data-product-id="{{id}}" aria-label="{{lang 'products.quick_view'}}: {{name}}">
                              <svg height="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 177.19 121.44" aria-hidden="true" focusable="false">
                                <path d="M601.62,385.81c-11.78,12.63-22.47,26.55-35.56,37.63-32.07,27.11-75,27.1-107.08.16-12.11-10.17-22.19-22.82-32.66-34.82-1.84-2.11-2.57-7.62-1.13-9.8,15.75-24,35.47-43.71,63.46-52.7s53.39-2,76.57,15.16c14.51,10.74,25.69,24.53,36.4,38.8Zm-89.49-51.73c-2.77.32-6.26.5-9.66,1.15-28.28,5.41-47.82,23.29-64.13,45.54-.85,1.16-.22,4.54.92,5.83,7.36,8.34,14.32,17.24,22.77,24.34,17.8,14.94,37.92,24.31,62.1,19.6,19.67-3.84,35.84-14.32,48.83-29,19.59-22.09,19.72-15.12-.21-37.21C557,346.85,537.3,335.34,512.13,334.08Z" transform="translate(-424.43 -322.35)"/>
                                <path d="M552.58,383.85c-.83,22.3-19.89,40.44-41.31,39.32-22.15-1.16-39.77-19.68-39-41,.84-22.3,19.89-40.43,41.32-39.32C535.76,344,553.38,362.55,552.58,383.85Zm-40.32,27.22a28,28,0,1,0-27.84-28.58A27.84,27.84,0,0,0,512.26,411.07Z" transform="translate(-424.43 -322.35)"/>
                                <path d="M527.69,383.35a15.64,15.64,0,0,1-15.4,14.93c-8.35-.11-15.51-7.66-15.08-15.93s7.73-14.9,15.73-14.58A15.63,15.63,0,0,1,527.69,383.35Z" transform="translate(-424.43 -322.35)"/>
                              </svg>
                              <span class="quickviewlabel-btn">{{lang 'products.quick_view'}}</span>
                            </button>
                        {{else}}
                            <button type="button" class="button button--small card-figcaption-button quickview" data-product-id="{{id}}" aria-label="{{lang 'products.quick_view'}}: {{name}}">
                              <svg height="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 177.19 121.44" aria-hidden="true" focusable="false">
                                <path d="M601.62,385.81c-11.78,12.63-22.47,26.55-35.56,37.63-32.07,27.11-75,27.1-107.08.16-12.11-10.17-22.19-22.82-32.66-34.82-1.84-2.11-2.57-7.62-1.13-9.8,15.75-24,35.47-43.71,63.46-52.7s53.39-2,76.57,15.16c14.51,10.74,25.69,24.53,36.4,38.8Zm-89.49-51.73c-2.77.32-6.26.5-9.66,1.15-28.28,5.41-47.82,23.29-64.13,45.54-.85,1.16-.22,4.54.92,5.83,7.36,8.34,14.32,17.24,22.77,24.34,17.8,14.94,37.92,24.31,62.1,19.6,19.67-3.84,35.84-14.32,48.83-29,19.59-22.09,19.72-15.12-.21-37.21C557,346.85,537.3,335.34,512.13,334.08Z" transform="translate(-424.43 -322.35)"/>
                                <path d="M552.58,383.85c-.83,22.3-19.89,40.44-41.31,39.32-22.15-1.16-39.77-19.68-39-41,.84-22.3,19.89-40.43,41.32-39.32C535.76,344,553.38,362.55,552.58,383.85Zm-40.32,27.22a28,28,0,1,0-27.84-28.58A27.84,27.84,0,0,0,512.26,411.07Z" transform="translate(-424.43 -322.35)"/>
                                <path d="M527.69,383.35a15.64,15.64,0,0,1-15.4,14.93c-8.35-.11-15.51-7.66-15.08-15.93s7.73-14.9,15.73-14.58A15.63,15.63,0,0,1,527.69,383.35Z" transform="translate(-424.43 -322.35)"/>
                              </svg>
                              <span class="quickviewlabel-btn">{{lang 'products.quick_view'}}</span>
                            </button>
                        {{/if}}
                    {{/if}}
                {{/unless}}

                {{#if show_compare}}
                  <label class="card-figcaption-button compareprod-btn" for="compare-{{id}}">
                    <svg height="15" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 358.4" aria-hidden="true" focusable="false">
                      <polygon points="179.46 230.4 0 230.4 0 281.6 179.46 281.6 179.46 358.4 281.6 256 179.46 153.6 179.46 230.4"/>
                      <polygon points="332.54 76.8 332.54 0 230.4 102.4 332.54 204.8 332.54 128 512 128 512 76.8 332.54 76.8"/>
                    </svg>
                      <span class="comparelabel-btn">{{lang 'products.compare'}} {{name}}</span>
                  </label>
                  <input class="hidden" type="checkbox" name="products[]" value="{{id}}" id="compare-{{id}}" data-compare-id="{{id}}" aria-label="{{lang 'products.compare'}} {{name}}">
                {{/if}}

            </div>
        </figcaption>
    </figure>

    <div class="card-body">
        
        {{#if theme_settings.show_product_card_swatch }}
            <div class="card-swatch" data-cardtype="{{product_type}}">
            <div class="form-field"> </div>
            </div><!--.card-swatch ends-->
        {{/if}}

        {{#if theme_settings.gb-show-brandname }}
        <p class="card-text card-brandname" data-test-info-type="brandName">
          {{#if brand.name}}
              {{brand.name}}
          {{/if}}
        </p>
        {{/if}}

        <h3 class="card-title">
            <a aria-label="{{name}},{{> components/products/product-aria-label}}"
               href="{{url}}"
               {{#if settings.data_tag_enabled}} data-event-type="product-click" {{/if}}>{{name}}</a>
        </h3>

        {{#if theme_settings.gb-show-ratings }}
            {{#and rating show_rating}}
                <p class="card-text" data-test-info-type="productRating">
                    <span class="rating--small">
                        {{> components/products/ratings rating_target=name rating=rating}}
                    </span>

                    <span class="card-review-total">+ {{ num_reviews }} reviews</span>
                </p>
            {{/and}}
        {{/if}}

        <div class="card-text card-price-holder" data-test-info-type="price">
            {{#or customer (if theme_settings.restrict_to_login '!==' true)}}
                {{> components/products/price price=price}}
            {{else}}
                {{> components/gordonbyte/common/login-for-pricing}}
            {{/or}}
        </div>
        {{> components/products/bulk-discount-rates}}

    </div>
    <div class="addtocart-btn">
    {{#or customer (if theme_settings.restrict_to_login '!==' true)}}
        {{#if show_cart_action}}
            {{#if has_options}}
                <a href="{{url}}" data-event-type="product-click" class="button card-figcaption-button" data-product-id="{{id}}">{{lang 'products.choose_options'}}</a>
            {{/if}}
            {{#if pre_order}}
                <a href="{{pre_order_add_to_cart_url}}" data-event-type="product-click" class="button card-figcaption-button">{{lang 'products.pre_order'}}</a>
            {{/if}}
            {{#if add_to_cart_url }}
                <a href="{{add_to_cart_url}}" data-event-type="product-click" class="button card-figcaption-button">{{lang 'products.add_to_cart'}}</a>
            {{/if}}
            {{#if out_of_stock_message }}
                <a href="{{url}}" data-event-type="product-click" class="button card-figcaption-button" data-product-id="{{id}}">{{out_of_stock_message}}</a>
            {{/if}}
        {{/if}}
    {{/or}}

    </div><!--.addtocart-btn ends-->
</article>
